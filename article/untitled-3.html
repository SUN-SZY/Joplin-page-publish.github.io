<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />
<link rel="stylesheet" href="/_assets/main.css" />


    <title>④总线 - Blog的历史分享</title>
  </head>
  <body>
    <div class="main">
      <nav class="navigation">
        <a href="/">Blog的主页（点此返回首页）</a>
      </nav>
      <article>
        <header>
          <h1 class="article-title">④总线</h1>
          <div class="article-info">
            <div>
              <span
                >Created At：<time datetime="1638237275000"
                  >2021-11-30 09:54</time
                ></span
              >
              <span
                >Updated At：<time datetime="1642922152394"
                  >2022-01-23 15:15</time
                ></span
              >
            </div>
            
            <div>
              Keywords: 
              <span class="keyword">计算机组成原理 - mooc</span>
              
            </div>
            
          </div>
        </header>
        <div class="article-content markdown-body"><nav class="table-of-contents"><ul><li><a href="#总线的基本概念">总线的基本概念</a></li><li><a href="#总线的分类">总线的分类</a></li><li><a href="#总线的性能及性能指标">总线的性能及性能指标</a></li><li><a href="#总线结构">总线结构</a></li><li><a href="#总线的控制">总线的控制</a><ul><li><a href="#总线的通信控制">总线的通信控制</a></li><li><a href="#总线通信的四种方式">总线通信的四种方式</a></li></ul></li></ul></nav><h2 id="总线的基本概念">总线的基本概念</h2>
<ul>
<li>为什么需要总线
<ul>
<li>分散链接
<ul>
<li>占用空间</li>
<li>实现难度比较大</li>
</ul>
</li>
</ul>
</li>
<li>总线连接
<ul>
<li>总线是连接各个部件的信息传输线</li>
<li>是各个部件共享的传输介质</li>
</ul>
</li>
<li>总线上的信息传送
<ul>
<li><img src="/_resources/52ee5a3d95f2405db7c5c0abee454fad.png" /></li>
<li>高速线缆传输使用的是串行</li>
</ul>
</li>
<li>总线结构的计算机
<ul>
<li>单总线<img src="/_resources/452ad91e2e3b4b79adacdedd42dcb218.png" /></li>
<li>只有一条总线的结构</li>
<li>缺点
<ul>
<li>任何时刻只能有一个设备使用（瓶颈问题）</li>
<li>如果主存设备在读写数据，其他设备会无法使用</li>
<li>如果CPU相I/O设备传输数据延迟非常大</li>
</ul>
</li>
<li>面向CPU双总线<img src="/_resources/fb96187d23d64f4dbcfdb8a4b3f95e95.png" />
<ul>
<li>缺点
<ul>
<li>CPU与主存之间提供一条总线</li>
<li>外部设备与主存交流时，没有直接通路，只能与中央处理器交流，CPU压力比较大</li>
</ul>
</li>
</ul>
</li>
<li>以存储器为中心的双总线结构图<img src="/_resources/b8aa0ef374134a31a6224d2ea812f82a.png" />
<ul>
<li>缺点
<ul>
<li>还是分时操作，两条总线依旧无法同时操作</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="总线的分类">总线的分类</h2>
<ul>
<li>根据总线的位置划分
<ul>
<li>片内总线
<ul>
<li>芯片内的总线（完成了不同元件之间的连接）</li>
</ul>
</li>
<li>系统总线（计算机各个部件之间的信息传输）
<ul>
<li>计算机各部件之间的信息传输线
<ul>
<li>数据总线（传输的数据信号）
<ul>
<li>双向，与机器字长、寄存器字长有关</li>
<li>总线宽度小于等于字长</li>
</ul>
</li>
<li>地址总线（由主设备或者CPU出）
<ul>
<li>单向，与存储地址、I/O地址有关(传输地址)</li>
<li>地址总条数线和地址单元相关，与MAR相等</li>
</ul>
</li>
<li>控制总线（传出控制状态信号）
<ul>
<li>有出 有入</li>
<li>CPU发出
<ul>
<li>存储器读、存储器写、总线允许、中断确认</li>
</ul>
</li>
<li>CPU接入
<ul>
<li>中断请求、总线请求</li>
</ul>
</li>
</ul>
</li>
<li>通信总线
<ul>
<li>用于 计算机系统之间 或 计算机系统与其他系统（如控制仪表、移动通信等）之间的通信</li>
<li>传输方式
<ul>
<li>串行</li>
<li>并行</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="总线的性能及性能指标">总线的性能及性能指标</h2>
<ul>
<li>物理实现<img src="/_resources/15e1e652575c4801afebdfe070a2919b.png" /></li>
<li>总线特性
<ul>
<li>机械特性
<ul>
<li>尺寸、形状、管脚数、排列顺序</li>
</ul>
</li>
<li>电气特性
<ul>
<li>传输方向和有效的电平范围</li>
</ul>
</li>
<li>功能特性
<ul>
<li>每根传输线的功能：地址、数据、控制</li>
</ul>
</li>
<li>时间特向
<ul>
<li>信号的时序关系</li>
</ul>
</li>
</ul>
</li>
<li>总线的性能指标</li>
</ul>
<table>
<thead>
<tr>
<th>总线宽度</th>
<th>数据线的根数</th>
</tr>
</thead>
<tbody>
<tr>
<td>标准传输速率</td>
<td>每秒传输的最大字节数（MBps）</td>
</tr>
<tr>
<td>时钟的同步/异步</td>
<td>同步、不同步</td>
</tr>
<tr>
<td>总线复用</td>
<td>地址线与数据线复用（减少芯片的管脚数，管脚数对CPU影响较大）</td>
</tr>
<tr>
<td>信号线数</td>
<td>地址线和控制线的总和</td>
</tr>
<tr>
<td>总线的控制方式</td>
<td>突发、自动、仲裁、逻辑、计数</td>
</tr>
<tr>
<td>其他指标</td>
<td>负载能力</td>
</tr>
</tbody>
</table>
<ul>
<li>总线标准<img src="/_resources/7978dd4f3e2b4b4a9faa4acce344b6af.png" />
<ul>
<li>发展类别<img src="/_resources/33672c1532dd41708318ed2d9096a3d3.png" /></li>
<li>ISA 一秒8MHz 传输两个字节 带宽为16MBps</li>
<li>EISA 兼容ISA带宽扩展一倍</li>
<li>VESA 视频传输格式，信号来自CPU驱动能力比较差</li>
<li>PCI 外设部件互联标准，最多的接口，独立于处理器的接口，中间缓冲器式的结构</li>
<li>AGP 点对点的局部总线，链接控制芯片和显卡</li>
<li>RS-232 串行总线标准</li>
<li>USB 通用串行总线标准</li>
</ul>
</li>
</ul>
<h2 id="总线结构">总线结构</h2>
<ul>
<li>单总线结构<img src="/_resources/0c1f15f799394f41b32ac24d725e7259.png" /></li>
<li>多总线结构
<ul>
<li>双总线结构<img src="/_resources/474288a90eba4faebed212cb292f79b3.png" />
<ul>
<li>一CPU 或者存储器为中心</li>
<li>主存总线和I/O总线，通过通道进行传输</li>
<li>通道具有控制器，由操作系统进行编写的</li>
<li>具有特殊功能。结构简单的处理器，专门用于输入输出操作</li>
</ul>
</li>
<li>三总线结构<img src="/_resources/ee272febf2684015a49cc2b5ce4a5924.png" />
<ul>
<li>DMA：直接存储器访问（外部设备直接访问存储器 高速访问）</li>
<li>I/O总线（低速设备访问主存依旧通过I/O总线）</li>
<li>主存总线</li>
</ul>
</li>
<li>三总线结构二<img src="/_resources/c79a57f07a5d46f79da56bf5fdfc870a.png" />
<ul>
<li>CPU和主存之间交换速度为最大</li>
<li>CPU速度比内存速度快的多</li>
<li>使用局部总线让CPU和cache连接到一起，解决I/O设备的传输问题</li>
<li>多种设备都链接到扩展总线上，会影响外围设备的速度。</li>
</ul>
</li>
<li>四总线结构<img src="/_resources/262d34ceb672494284e7eb769b2da1c3.png" />
<ul>
<li>局部总线：实现CPU和桥之间的链接</li>
<li>系统总线：实现主存和桥的链接</li>
<li>高速总线：高速设备链接</li>
<li>低速总线：高速和低速的分开实现效率最大化</li>
</ul>
</li>
</ul>
</li>
<li>总线结构举例
<ul>
<li>传统微机型总线结构<img src="/_resources/0f426a4084d047189d1e644ff47d64e0.png" /></li>
<li>VL-BUS局部总线结构<img src="/_resources/886a2f317f4041e88b7b22f054d86970.png" />
<ul>
<li>高速设备和低速设备分离</li>
</ul>
</li>
<li>PCI总线结构<img src="/_resources/100f5775416c4652923d056ab8fc9b10.png" />
<ul>
<li>对多设备承载能力不够</li>
</ul>
</li>
<li>多层PCI总线结构<img src="/_resources/d32502546f594d358543a313e0669d60.png" />
<ul>
<li>总线驱动能力强化版</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="总线的控制">总线的控制</h2>
<ul>
<li>总线的判优控制
<ul>
<li>原因：在同一时刻收到多个请求</li>
<li>原因：占用通信时如何保证正确性</li>
<li>基本概念<img src="/_resources/61e116eeaaa64e118a9af77d247a0e5b.png" />
<ul>
<li>主设备是有控制权的，可以发送也可以接受，从设备只能响应主设备发出的命令。有部分设备是可以做主设备也可以做从设备</li>
<li>分布式：将所有的判优分到从设备上</li>
</ul>
</li>
<li>链式查询的方式<img src="/_resources/a893d883f28942dc9a0c50c6dbc3a298.png" />
<ul>
<li>总线控制部件在一起，是集中式的特征</li>
<li>数据总线：用于数据交换</li>
<li>地址总线：主设备通过地址找到通讯的从设备</li>
<li>总线设备，所有的设备都通过BR发送总线请求</li>
<li>如果有设备占用则通过BS发送总线忙</li>
<li>BG是一个一个的向下查询</li>
<li>逻辑模块
<ul>
<li>通过BR向总线提出请求</li>
<li>总线控制不知道是哪个设备提出</li>
<li>通过BG向每个设备依次发出询问</li>
<li>直到找到第一个发出请求的设备，即完成找到设备</li>
<li>随机通过BS发出总线忙</li>
</ul>
</li>
<li>提出总线占用请求的设备是按照优先级排列的</li>
<li>缺点：对电路设备故障敏感，如果有一个电路无法向下传送信号，则设备崩坏</li>
<li>优点：结构简单可靠，比较容易实现。判优过程可以把BS、BG多设置几条线、读取速度较慢</li>
</ul>
</li>
<li>计数器定时查询方式<img src="/_resources/ec615b37afc24be2b6a5b5f8219a0940.png" />
<ul>
<li>相同，有地址线和数据线，多了个设备地址线，用来传输计数器给出的地址，用来查找地址设备发出的总线请求</li>
<li>逻辑
<ul>
<li>主设备占用总线传输</li>
<li>通过BR提出总线占用请求</li>
<li>总线设备计数器给出地址，通过设备地址线向设备询问，如果没有发出请求则计数器+1如果选中的话则响应设备。</li>
<li>优点：优先级设备响应灵活，计数器每次查询都是从0开始n结束，如果不是从0开始的话，就变成了循环优先值。</li>
<li>少了一条BG线，多了一条设备地址线，设备地址线和设备数量有关、</li>
</ul>
</li>
</ul>
</li>
<li>独立请求方式<img src="/_resources/8cb737fae88d430b90b778c65dcddb4d.png" />
<ul>
<li>能更快的确定设备占用。</li>
<li>优先级的排队，由总线控制部件内部进行排队，或者事先进行优先级排队，也可以采用自适应和计数器，混合模式等。</li>
<li>对应答设备进行判优，谁回答，谁优秀</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="总线的通信控制">总线的通信控制</h3>
<ul>
<li>目的 解决通信双方协调配合问题（主从设备）</li>
<li>总线传输周期（主从设备完成一次完整地可靠的通信）
<ul>
<li>申请分配
<ul>
<li>主模块申请，总线仲裁决定（总线判优逻辑）</li>
</ul>
</li>
<li>寻址阶段
<ul>
<li>主模块向从模块给出地址和命令</li>
</ul>
</li>
<li>传数模块
<ul>
<li>主模块和从模块交换数据</li>
</ul>
</li>
<li>结束阶段
<ul>
<li>主模块撤销有关信息</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="总线通信的四种方式">总线通信的四种方式</h3>
<ul>
<li>同步通信
<ul>
<li>由统一时标控制数据传送</li>
<li>同步式数据输入<img src="/_resources/0c3df7ebaaf5442da3df84b6f6ec83c5.png" />
<ul>
<li>在固定的时间点上需要给定操作</li>
<li>需要有定宽定距的时钟</li>
</ul>
</li>
<li>同步式数据输出<img src="/_resources/aa8aad3f3e794db6b04769f5a1cd4445.png" />
<ul>
<li>所有从模块都用同一个时钟控制</li>
<li>强制统一为最慢的那个进行数据传输</li>
<li>应用在，数据线比较短，各个模块存取时间比较一致</li>
</ul>
</li>
</ul>
</li>
<li>异步通信
<ul>
<li>采用应答方式，没有公共时钟标准<img src="/_resources/da8211f08c0e4a50a15a5c7c64e47f46.png" /></li>
<li>不互锁
<ul>
<li>这个过程中，无论主设备是否接受到信号，在一定时间之后就会撤销任务，因此通信可靠性比较低</li>
</ul>
</li>
<li>半互锁
<ul>
<li>在这个过程中，如果收不到信号会持续发送，但是从设备会在无论是否收到信息都会撤销任务，因此会导致请求信号高频任务</li>
</ul>
</li>
<li>全互锁
<ul>
<li>在这个过程中，主设备发出请求，从设备收到应答，主设备收到应答之后才会撤销任务，会完成可靠传输。会发现数据出错，半互锁和全互锁会重新发送或者接受数据</li>
</ul>
</li>
</ul>
</li>
<li>半同步通信
<ul>
<li>同步。异步结合
<ul>
<li>同步：发送方 用系统 时钟前沿 发信号，接收方 用系统 时钟后沿 判断、识别</li>
<li>异步：允许不同速度的模块和谐工作，增加一条 “等待”响应信号 WAIT</li>
<li>以输入数据为例的半同步通信时序<img src="/_resources/d27c2a01eda044fb83626b2efeaa0c46.png" />
<ul>
<li>四个时钟周期</li>
<li>T1主模块发出地址</li>
<li>T2主模块发出命令（主模块发出检测命令等待，当标志变为高电平时才会发出命令）</li>
<li>T3从模块提出数据</li>
<li>T4从模块撤销数据，主模块撤销命令（主模块和从模块速度不一致，在T3时钟到来之前从模块无法向主模块提供数据）</li>
</ul>
</li>
<li>以输入数据为例的半同步通信<img src="/_resources/341e59942bdb4517bc98c9b1a96db32a.png" />
<ul>
<li>第一个时钟周期开始时，CPU给出地址线</li>
<li>第二个时钟周期CPU给出读信号</li>
<li>第三个时钟周期，如果从设备无法不能准备好数据，将会发出wait信号，会在第三个周期到来之前会插入wait信号</li>
<li>第四个周期，开始时读命令和写命令会在总线上撤销命令</li>
<li>允许不同传输速度的设备进行通信</li>
</ul>
</li>
<li>共同点
<ul>
<li>一个总线传输周期（以输入数据为例）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<tbody>
<tr>
<td>|主模块发地址 、命令</td>
<td>占用总线</td>
</tr>
<tr>
<td>|从模块准备数据 |不占用总线</td>
<td>总线空闲</td>
</tr>
<tr>
<td>|从模块向主模块发数据</td>
<td>占用总线</td>
</tr>
</tbody>
</table>
<ul>
<li>分离式通信
<ul>
<li>充分挖掘系统总线每个瞬间的潜力</li>
<li>一个总线传输周期<img src="/_resources/aabd90ccac9344b490abc5aad27adf02.png" /></li>
<li>分离通信的特点
<ul>
<li>各模块有权申请占用总线</li>
<li>采用同步方式通信，不用等对方应答</li>
<li>各模块被占用时，无空闲</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
      </article>
    </div>
  </body>
</html>
